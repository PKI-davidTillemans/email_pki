# Verslag: Signing & Encryption with EJBCA and Evolution

## Groep 4 - Jelle, Ilias, Sem, Mayk, Robbe, Jentse, Cedric

### Evolution Installation

We began by installing Evolution as our mail client on Linux, known for its reliability and suitability for our requirements. We created new email accounts named jentse.evolution@hotmail.com and jacksonmate356@hotmail.com for this task.

To install Evolution, we used the following command:
```bash
sudo apt install evolution
Once Evolution was installed, we opened it with the command:
```
```bash
evolution
```
Now, open Evolution and add your email account.

After setting up these configurations, we are ready to use IMAP and SMTP for sending and receiving emails securely.

EJBCA Certificates for Signing
Initially, we worked on generating a certificate, similar to the previous task where the user uploads a CSR and receives a certificate from EJBCA. This certificate allowed us to sign emails, but there was an issue with CN (Common Name) mismatch, as shown in the screenshot.

To resolve this, we added the email attribute to our Entity End profile, which was missing and causing the mismatch during signing. We also modified our certificate attributes to allow both signing and encryption. By default, these certificates only allow signing, but now we permit Data Encipherment for encryption.

With our updated End Entity profile and correctly configured certificate attributes, we requested EJBCA to generate a certificate for our email account. This certificate type matches the one we created, with the necessary settings for email encryption and signing. Instead of manually uploading a CSR, we simply generated a certificate from the CA with the CN as the email account's name.

CN, in this case, is the name of our email account: jentse.evolution@hotmail.com. We also checked the email attribute to link it. Then, we provided user credentials to secure the certificate. We noticed that Data Encipherment and Digital Signature were enabled in the Key Usage, allowing us to both sign and encrypt emails.

Next, we downloaded this certificate as PKCS#12, which is the standard format expected by Evolution.

Subsequently, we imported the certificate into Evolution. The PKCS#12 file contained our CN and email attributes, along with the issuer of our certificate (EJBCA). We also imported the root CA on our Linux machine to establish trust.

We imported the certificate into Evolution to use it for signing. During this process, Evolution asked for the password set in EJBCA for user credentials.

Once the certificate was imported, we configured our email account to use it for signing. This was done by going to Preferences > Mail accounts > editing our email account > Security.

We selected the imported certificate and indicated our intention to sign our emails from now on.

If all went well, we could now see an email signed by the EJBCA certificate for jentse.evolution@hotmail.com.

Setting Up Encryption
When creating an encryption certificate, it's important to use the CN of the email recipient.

Add the encryption certificate to Evolution. Select the appropriate certificate.

Create an email and press the button to sign and encrypt the email.

Here's what the recipient sees.

Encrypted emails can also be decrypted if we import the certificate generated by EJBCA for the email jacksonmate356@hotmail.com.

Threat Model
